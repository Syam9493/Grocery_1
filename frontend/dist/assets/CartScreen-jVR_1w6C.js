import{d as y,o as h,j as e,z as f,A as j,y as x,r as m,L as p,n as g,v as b}from"./index-DhnlV0K8.js";import{a as w,b as N,c as v}from"./cartApi-Dqz5AsWL.js";import{L as C,b as D,q as I,F as k,z as F}from"./ExclamationTriangleIcon-Bnu-F8Ga.js";import{O as E}from"./OrderSummary-DWDslmiB.js";import"./vendor-DJG_os-6.js";const q=({open:t,setOpen:a,id:l,refetch:r})=>{const i=y(),[o]=w(),{userID:n}=h(),s=async()=>{try{i(f(l)),i(j(l)),x.success("Product added to WishList",{autoClose:1e3,theme:"colored"}),a(!1)}catch(d){console.error("Error adding to wishlist:",d),x.error("Error adding to wishlist!")}finally{a(!1)}},c=async()=>{const d=l;try{const u=await o({userID:n,itemID:d}).unwrap();await r(),x.info(u.message,{autoClose:1e3,theme:"colored"})}catch(u){console.error("DELETE FAILED:",u),x.error("Error deleting product!",{autoClose:1e3,theme:"colored"})}finally{a(!1)}};return e.jsx(e.Fragment,{children:e.jsxs(C,{open:t,onClose:a,className:"relative z-10",children:[e.jsx(D,{className:"fixed inset-0 bg-black/50"}),e.jsx("div",{className:"fixed inset-0 z-10 w-screen overflow-y-auto",children:e.jsx("div",{className:"flex min-h-full items-center justify-center p-4 text-center",children:e.jsxs(I,{className:"relative transform overflow-hidden rounded-xl bg-white text-left shadow-xl transition-all sm:w-full sm:max-w-lg",children:[e.jsx("div",{className:"bg-white p-6",children:e.jsxs("div",{className:"flex items-center space-x-4",children:[e.jsx("div",{className:"flex-shrink-0",children:e.jsx(k,{className:"h-10 w-10 text-red-600","aria-hidden":"true"})}),e.jsxs("div",{children:[e.jsx(F,{as:"h3",className:"text-lg font-medium leading-6 text-gray-900",children:"Remove Item from Cart"}),e.jsx("p",{className:"mt-2 text-sm text-gray-500",children:"Are you sure you want to remove this item from your cart?"})]})]})}),e.jsxs("div",{className:"bg-gray-50 px-6 py-3 flex justify-end space-x-2",children:[e.jsx("button",{type:"button",onClick:s,className:"inline-flex justify-center rounded-md bg-blue-600 px-4 py-2 text-sm font-medium text-white hover:bg-blue-500",children:"Move to Wishlist"}),e.jsx("button",{type:"button",onClick:c,className:"inline-flex justify-center rounded-md bg-red-600 px-4 py-2 text-sm font-medium text-white hover:bg-red-500",children:"Remove"}),e.jsx("button",{type:"button",onClick:()=>a(!1),className:"inline-flex justify-center rounded-md border border-gray-300 bg-white px-4 py-2 text-sm font-medium text-gray-700 hover:bg-gray-100",children:"Cancel"})]})]})})})]})})},L=({product:t,refetch:a})=>{const{userID:l}=h(),[r]=N(),i=async(n,s)=>{const c=String(n);try{await r({userID:l,productID:c,quantity:s}),await a()}catch(d){console.error("Failed to increase quantity:",d)}},o=async(n,s)=>{const c=String(n);try{await r({userID:l,productID:c,quantity:s}),await a()}catch(d){console.error("Failed to decrease quantity:",d)}};return e.jsx(e.Fragment,{children:e.jsxs("div",{className:"inline-flex items-center border border-black rounded-full overflow-hidden",children:[e.jsx("button",{className:"px-3 py-1 border-r border-gray-400 text-sm",onClick:()=>o(t._id,t.quantity-1),disabled:t.quantity===1,children:"-"}),e.jsx("h1",{className:"px-4 text-sm",children:t.quantity}),e.jsx("button",{className:"px-3 py-1 border-l border-gray-400 text-sm",onClick:()=>i(t._id,t.quantity+1),children:"+"})]},t._id)})},S=({product:t,refetch:a})=>{const[l,r]=m.useState(!1),[i,o]=m.useState(""),n=s=>{o(s),r(!0)};return e.jsxs(e.Fragment,{children:[t.map(s=>{var c;return e.jsxs("tr",{className:"bg-white rounded-lg shadow-sm mt-4",children:[e.jsxs("td",{className:"flex items-center gap-4 p-4",children:[e.jsx("button",{className:"text-xl text-gray-500 hover:text-red-500",onClick:()=>n(s.productID),children:"x"}),e.jsx("img",{src:(c=s.image)==null?void 0:c[0],alt:s.name,className:"size-16 border border-gray-200 shadow-gray-200 object-contain rounded p-1.5"}),e.jsxs("div",{className:"px-7",children:[e.jsx(p,{to:`/productDetailsPage/${s._id}`,children:e.jsx("p",{className:"font-medium",children:s.name})}),e.jsx("p",{className:"text-sm text-gray-400",children:s.weight})]})]}),e.jsxs("td",{className:"p-4",children:["₹",s.price]}),e.jsx("td",{className:"p-1",children:e.jsx(L,{product:{_id:s.productID,quantity:s.quantity},refetch:a})}),e.jsxs("td",{className:"p-4",children:["₹",s.subtotal.toFixed(2)]})]},s._id)}),e.jsx(q,{open:l,setOpen:r,id:i,refetch:a})]})},T=()=>{var s;const t=y(),{userID:a}=h(),l=g(),{data:r,isSuccess:i,refetch:o}=v(a,{skip:!a}),n=(s=r==null?void 0:r.data)==null?void 0:s.cartItems;return m.useEffect(()=>{window.scrollTo(0,0)},[l]),m.useEffect(()=>{i&&r&&t(b(r))},[i,r,t]),e.jsx(e.Fragment,{children:e.jsxs("div",{className:"flex flex-col lg:flex-row justify-center items-start gap-8 p-4 sm:p-6 md:p-10 md:gap-3 lg:px-14 lg:gap-5",children:[e.jsx("div",{className:"w-full lg:w-2/4 overflow-x-auto",children:e.jsxs("table",{className:"min-w-full table-auto text-left",children:[e.jsx("thead",{children:e.jsxs("tr",{className:"bg-yellow-500 text-white",children:[e.jsx("th",{className:"p-4 text-sm sm:text-base",children:"Product"}),e.jsx("th",{className:"p-4 text-sm sm:text-base",children:"Price"}),e.jsx("th",{className:"p-4 text-sm sm:text-base",children:"Quantity"}),e.jsx("th",{className:"p-4 text-sm sm:text-base",children:"Subtotal"})]})}),e.jsx("tbody",{className:"bg-white divide-y divide-gray-200",children:Array.isArray(n)&&e.jsx(S,{product:n,refetch:o})})]})}),e.jsx(E,{})]})})};export{T as default};
