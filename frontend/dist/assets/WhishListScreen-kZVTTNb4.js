import{r as u,d as j,u as N,j as e,C as I,B as z,y as c,o as v,v as F,z as W}from"./index-DhnlV0K8.js";import{L as A,b as S,q as U,F as k,z as T}from"./ExclamationTriangleIcon-Bnu-F8Ga.js";import{b as q,u as E}from"./whishListSlice-qUN5bicp.js";import{u as P}from"./cartApi-Dqz5AsWL.js";import"./vendor-DJG_os-6.js";const R=({open:a,setOpen:i,id:t})=>{const[o,r]=u.useState(!1),x=j(),h=N(),p=async f=>{x(z(f)),c.info("Product deleted from wishList!",{autoClose:500,theme:"colored"}),i(!1),r(!0),setTimeout(()=>{h("/whishList"),r(!1)},2e3)};return o?e.jsx("div",{className:"flex justify-center m-20",children:e.jsx(I,{size:100})}):e.jsx("div",{children:e.jsxs(A,{open:a,onClose:i,className:"relative z-10",children:[e.jsx(S,{transition:!0,className:"fixed inset-0 bg-gray-500/75 transition-opacity data-closed:opacity-0 data-enter:duration-300 data-enter:ease-out data-leave:duration-200 data-leave:ease-in"}),e.jsx("div",{className:"fixed inset-0 z-10 w-screen overflow-y-auto",children:e.jsx("div",{className:"flex min-h-full items-end justify-center p-4 text-center sm:items-center sm:justify-center sm:p-0",children:e.jsxs(U,{transition:!0,className:"relative transform overflow-hidden rounded-lg bg-white text-left shadow-xl transition-all data-closed:translate-y-4 data-closed:opacity-0 data-enter:duration-300 data-enter:ease-out data-leave:duration-200 data-leave:ease-in sm:my-8 sm:w-full sm:max-w-lg data-closed:sm:translate-y-0 data-closed:sm:scale-95",children:[e.jsx("div",{className:"bg-white px-4 pt-5 pb-4 sm:p-6 sm:pb-4",children:e.jsxs("div",{className:"sm:flex sm:items-start",children:[e.jsx("div",{className:"mx-auto flex size-12 shrink-0 items-center justify-center rounded-full bg-red-100 sm:mx-0 sm:size-10",children:e.jsx(k,{"aria-hidden":"true",className:"size-6 text-red-600"})}),e.jsxs("div",{className:"mt-3 text-center sm:mt-0 sm:ml-4 sm:text-left",children:[e.jsx(T,{as:"h3",className:"text-base font-semibold text-gray-900",children:"Delete from wishList"}),e.jsx("div",{className:"mt-2",children:e.jsx("p",{className:"text-sm text-gray-500",children:"Are you sure you want to delete from your wishList?"})})]})]})}),e.jsxs("div",{className:"bg-gray-50 px-4 py-3 sm:flex sm:flex-row-reverse sm:px-6",children:[e.jsx("button",{type:"button",onClick:()=>p(t),className:"inline-flex w-full justify-center rounded-md bg-red-600 px-3 py-2 text-sm font-semibold text-white shadow-xs hover:bg-red-500 sm:ml-3 sm:w-auto",children:"Remove"}),e.jsx("button",{type:"button","data-autofocus":!0,onClick:()=>i(!1),className:"mt-3 inline-flex w-full justify-center rounded-md bg-white px-3 py-2 text-sm font-semibold text-gray-900 shadow-xs ring-1 ring-gray-300 ring-inset hover:bg-gray-50 sm:mt-0 sm:w-auto",children:"Cancel"})]})]})})})]})})},H=({wishListItems:a,isLoading:i,isError:t})=>{var w;const[o,r]=u.useState(!1),[x,h]=u.useState(""),p=j(),f=N(),[C]=P(),[y]=q(),{userID:m}=v(),g=((w=a==null?void 0:a.wishList)==null?void 0:w.products)||[];console.log("Wish List Items:",g);const L=async s=>{var b;if(!s){console.error("No item provided");return}const n=s.productID||s._id;if(!n){console.error("Item has no ID",s);return}const l={_id:n,name:s.name,image:s.image,price:s.price,quantity:s.quantity||1,weight:s.weight,subtotal:s.price*(s.quantity||1)};if(console.log("Adding to cart:",l),!m){c.error("Please log in to add items to your cart."),f("/login");return}try{const d=await C({userID:m,product:l}).unwrap();await y({userID:m,productID:n}).unwrap(),console.log("Cart Update Result:",d),p(F(d)),c.success(d.message,{autoClose:500,position:"top-right",theme:"colored"})}catch(d){console.error("Cart Update Failed:",d),c.error(((b=d.data)==null?void 0:b.message)||"Failed to add product to cart.")}},D=async s=>{var l;const n=await y({userID:m,productID:s});console.log(n),c.info((l=n.data)==null?void 0:l.message,{autoClose:500})};return e.jsx(e.Fragment,{children:i?e.jsx("div",{children:"Loading..."}):t?e.jsx("tr",{children:e.jsx("td",{children:t.message})}):Array.isArray(g)?g.map(s=>e.jsxs("tr",{className:"bg-white rounded-lg shadow-sm mt-4",children:[e.jsxs("td",{className:"flex items-center gap-4 p-4",children:[e.jsx("button",{className:"text-xl text-gray-500 hover:text-red-500",onClick:()=>{r(!0),h(s.productID),D(s.productID)},children:"x"}),e.jsx("img",{src:s.image[0],alt:s.name,className:"size-14 object-contain rounded"}),e.jsxs("div",{children:[e.jsx("p",{className:"font-medium",children:s.name}),e.jsx("p",{className:"text-sm text-gray-400",children:s.weight})]})]}),e.jsxs("td",{className:"p-4",children:["â‚¹",s.price]}),e.jsx("td",{className:"p-4",children:new Date(s.updatedAt).toISOString().split("T")[0]}),e.jsxs("td",{children:[" ",e.jsx("button",{className:"flex items-center justify-center bg-green-700 text-white border-gray-50 rounded-4xl px-4 py-2",onClick:()=>L(s,s.productID),children:"Move To Cart"})]})]},s._id)):e.jsx("tr",{children:e.jsx("td",{children:e.jsx(R,{open:o,setOpen:r,id:x})})})})},J=()=>{const a=j(),{userID:i}=v(),{data:t,isLoading:o,error:r}=E(i);return console.log("Fetched Wishlist Items:",t),u.useEffect(()=>{t&&a(W(t.wishList||[]))},[a,t]),o?e.jsx("div",{children:"Loading..."}):r?e.jsx("div",{children:"Error fetching wishlist"}):e.jsx(e.Fragment,{children:e.jsxs("table",{className:"table-auto text-left mt-5 mb-5 mx-auto",children:[e.jsx("thead",{children:e.jsxs("tr",{className:"border-2 bg-yellow-500 text-white",children:[e.jsx("th",{className:"p-4",children:"Product"}),e.jsx("th",{className:"p-4",children:"Price"}),e.jsx("th",{className:"p-4",children:"Date Added"}),e.jsx("th",{className:"p-4",children:"Stock Status"})]})}),e.jsx("tbody",{children:e.jsx(H,{wishListItems:t,isLoading:o,isError:r})})]})})};export{J as default};
